<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Remind Me Later</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="123456789import pandas as pdimport numpy as npimport akshare as akimport scipy.stats as st# pd.set_option(&amp;#x27;display.float_format&amp;#x27;,lambda x : &amp;#x27;%.4f&amp;#x27; % x)np.set_printoptions(suppress&#x3D;">
<meta property="og:type" content="article">
<meta property="og:title" content="Remind Me Later">
<meta property="og:url" content="https://blog.skasis.com/2023/05/25/%E9%87%91%E8%9E%8D%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%88%86%E6%9E%90-python%E5%AE%9E%E7%8E%B0/index.html">
<meta property="og:site_name" content="Remind Me Later">
<meta property="og:description" content="123456789import pandas as pdimport numpy as npimport akshare as akimport scipy.stats as st# pd.set_option(&amp;#x27;display.float_format&amp;#x27;,lambda x : &amp;#x27;%.4f&amp;#x27; % x)np.set_printoptions(suppress&#x3D;">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-05-26T01:05:00.866Z">
<meta property="article:modified_time" content="2023-05-26T01:05:00.899Z">
<meta property="article:author" content="卞儒汉">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Remind Me Later" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Remind Me Later</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">太多东西要写了。。。</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://blog.skasis.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-金融时间序列分析-python实现" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/05/25/%E9%87%91%E8%9E%8D%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%88%86%E6%9E%90-python%E5%AE%9E%E7%8E%B0/" class="article-date">
  <time class="dt-published" datetime="2023-05-26T01:05:00.866Z" itemprop="datePublished">2023-05-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> akshare <span class="keyword">as</span> ak</span><br><span class="line"><span class="keyword">import</span> scipy.stats <span class="keyword">as</span> st</span><br><span class="line"><span class="comment"># pd.set_option(&#x27;display.float_format&#x27;,lambda x : &#x27;%.4f&#x27; % x)</span></span><br><span class="line">np.set_printoptions(suppress=<span class="literal">True</span>,   precision=<span class="number">20</span>,  threshold=<span class="number">10</span>,  linewidth=<span class="number">40</span>)  </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> IPython.core.interactiveshell <span class="keyword">import</span> InteractiveShell</span><br><span class="line">InteractiveShell.ast_node_interactivity = <span class="string">&quot;all&quot;</span></span><br></pre></td></tr></table></figure>
<h1 id="chapter-1">chapter 1</h1>
<h2 id="exercise-1">exercise 1</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pd.read_csv(&quot;./数据集/d-axp3dx-0111.txt&quot;, sep=r&quot;\ &quot;)</span></span><br><span class="line">data = pd.read_fwf(<span class="string">&quot;./数据集/d-axp3dx-0111.txt&quot;</span>) <span class="comment"># 等宽录入</span></span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
date
</th>
<th>
axp
</th>
<th>
vw
</th>
<th>
ew
</th>
<th>
sp
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
20010904
</td>
<td>
0.000824
</td>
<td>
-0.001658
</td>
<td>
-0.005708
</td>
<td>
-0.000565
</td>
</tr>
<tr>
<th>
1
</th>
<td>
20010905
</td>
<td>
0.007682
</td>
<td>
-0.003242
</td>
<td>
-0.008926
</td>
<td>
-0.001059
</td>
</tr>
<tr>
<th>
2
</th>
<td>
20010906
</td>
<td>
-0.039477
</td>
<td>
-0.020733
</td>
<td>
-0.014187
</td>
<td>
-0.022390
</td>
</tr>
<tr>
<th>
3
</th>
<td>
20010907
</td>
<td>
-0.019274
</td>
<td>
-0.017769
</td>
<td>
-0.011476
</td>
<td>
-0.018637
</td>
</tr>
<tr>
<th>
4
</th>
<td>
20010910
</td>
<td>
0.011850
</td>
<td>
0.003513
</td>
<td>
-0.007368
</td>
<td>
0.006226
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(data</span><br><span class="line"> .melt(id_vars=<span class="string">&quot;date&quot;</span>, value_vars=[<span class="string">&#x27;axp&#x27;</span>, <span class="string">&#x27;vw&#x27;</span>, <span class="string">&#x27;ew&#x27;</span>, <span class="string">&#x27;sp&#x27;</span>], var_name=<span class="string">&quot;asset_name&quot;</span>, value_name=<span class="string">&quot;return&quot;</span>)</span><br><span class="line"> .groupby(<span class="string">&#x27;asset_name&#x27;</span>)[<span class="string">&#x27;return&#x27;</span>]</span><br><span class="line"> .agg([np.mean, np.std, <span class="string">&#x27;skew&#x27;</span>, pd.Series.kurt, <span class="built_in">min</span>,<span class="built_in">max</span>, ])</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
mean
</th>
<th>
std
</th>
<th>
skew
</th>
<th>
kurt
</th>
<th>
min
</th>
<th>
max
</th>
</tr>
<tr>
<th>
asset_name
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
axp
</th>
<td>
0.000534
</td>
<td>
0.026368
</td>
<td>
0.460318
</td>
<td>
9.623330
</td>
<td>
-0.175949
</td>
<td>
0.206485
</td>
</tr>
<tr>
<th>
ew
</th>
<td>
0.000626
</td>
<td>
0.012080
</td>
<td>
-0.247703
</td>
<td>
8.135601
</td>
<td>
-0.078240
</td>
<td>
0.107422
</td>
</tr>
<tr>
<th>
sp
</th>
<td>
0.000094
</td>
<td>
0.013779
</td>
<td>
0.008162
</td>
<td>
8.561014
</td>
<td>
-0.090350
</td>
<td>
0.115800
</td>
</tr>
<tr>
<th>
vw
</th>
<td>
0.000224
</td>
<td>
0.013652
</td>
<td>
-0.098435
</td>
<td>
8.008957
</td>
<td>
-0.089762
</td>
<td>
0.114889
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(data.assign(axp = <span class="keyword">lambda</span> df: np.log(<span class="number">1</span>+df.axp),</span><br><span class="line">            vw = <span class="keyword">lambda</span> df: np.log(<span class="number">1</span>+df.vw),</span><br><span class="line">             ew = <span class="keyword">lambda</span> df: np.log(<span class="number">1</span>+df.ew),</span><br><span class="line">             sp = <span class="keyword">lambda</span> df: np.log(<span class="number">1</span>+df.sp)</span><br><span class="line">            )</span><br><span class="line"> .melt(id_vars=<span class="string">&quot;date&quot;</span>, value_vars=[<span class="string">&#x27;axp&#x27;</span>, <span class="string">&#x27;vw&#x27;</span>, <span class="string">&#x27;ew&#x27;</span>, <span class="string">&#x27;sp&#x27;</span>], var_name=<span class="string">&quot;asset_name&quot;</span>, value_name=<span class="string">&quot;return&quot;</span>)</span><br><span class="line"> .groupby(<span class="string">&#x27;asset_name&#x27;</span>)[<span class="string">&#x27;return&#x27;</span>]</span><br><span class="line"> .agg([np.mean, np.std, <span class="string">&#x27;skew&#x27;</span>, pd.Series.kurt, <span class="built_in">min</span>,<span class="built_in">max</span>])</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
mean
</th>
<th>
std
</th>
<th>
skew
</th>
<th>
kurt
</th>
<th>
min
</th>
<th>
max
</th>
</tr>
<tr>
<th>
asset_name
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
axp
</th>
<td>
1.880014e-04
</td>
<td>
0.026294
</td>
<td>
0.021017
</td>
<td>
9.050195
</td>
<td>
-0.193523
</td>
<td>
0.187711
</td>
</tr>
<tr>
<th>
ew
</th>
<td>
5.525758e-04
</td>
<td>
0.012100
</td>
<td>
-0.427821
</td>
<td>
8.044634
</td>
<td>
-0.081470
</td>
<td>
0.102035
</td>
</tr>
<tr>
<th>
sp
</th>
<td>
-7.486380e-07
</td>
<td>
0.013790
</td>
<td>
-0.206601
</td>
<td>
8.350592
</td>
<td>
-0.094695
</td>
<td>
0.109572
</td>
</tr>
<tr>
<th>
vw
</th>
<td>
1.307504e-04
</td>
<td>
0.013670
</td>
<td>
-0.300708
</td>
<td>
7.906623
</td>
<td>
-0.094049
</td>
<td>
0.108755
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">df1 = (data.assign(axp = <span class="keyword">lambda</span> df: np.log(<span class="number">1</span>+df.axp),</span><br><span class="line">            vw = <span class="keyword">lambda</span> df: np.log(<span class="number">1</span>+df.vw),</span><br><span class="line">             ew = <span class="keyword">lambda</span> df: np.log(<span class="number">1</span>+df.ew),</span><br><span class="line">             sp = <span class="keyword">lambda</span> df: np.log(<span class="number">1</span>+df.sp)</span><br><span class="line">            )</span><br><span class="line">.axp</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">res = st.ttest_1samp(df1,popmean=<span class="number">0</span>)</span><br><span class="line">res</span><br><span class="line">res.confidence_interval(<span class="number">0.95</span>)</span><br></pre></td></tr></table></figure>
<pre><code>TtestResult(statistic=0.3599871814354045, pvalue=0.7188867193267375, df=2534)






ConfidenceInterval(low=-0.0008360686196859006, high=0.0012120714468917763)</code></pre>
<h2 id="exercise-2">exercise 2</h2>
<p>Answer the same questions as Problem 1 but using monthly returns for
Gen- eral Electric (GE), CRSP value-weighted index (VW), CRSP
equal-weighted index (EW), and S&amp;P composite index from January 1940
to September 2011. The returns include dividend distributions. Data file
is m-ge3dx-4011.txt (date, ge, vw, ew, sp).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data = pd.read_fwf(<span class="string">&#x27;./数据集/m-ge3dx-4011.txt&#x27;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 异常值替换</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">replace_dot</span>(<span class="params">x : <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">if</span> x == <span class="string">&#x27;.&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x    </span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(data</span><br><span class="line">.assign(sp = <span class="keyword">lambda</span> df: df.sp.<span class="built_in">map</span>(replace_dot).astype(<span class="built_in">float</span>))</span><br><span class="line">.melt(id_vars=<span class="string">&#x27;date&#x27;</span>, value_vars=[<span class="string">&#x27;ge&#x27;</span>, <span class="string">&#x27;vw&#x27;</span>, <span class="string">&#x27;ew&#x27;</span>, <span class="string">&#x27;sp&#x27;</span>], var_name=<span class="string">&#x27;asset_name&#x27;</span>, value_name=<span class="string">&#x27;return&#x27;</span>, ignore_index=<span class="literal">True</span>)</span><br><span class="line">.groupby(<span class="string">&#x27;asset_name&#x27;</span>)[<span class="string">&#x27;return&#x27;</span>]</span><br><span class="line">.agg([np.mean, np.std, <span class="string">&#x27;skew&#x27;</span>, pd.Series.kurt, <span class="built_in">min</span>,<span class="built_in">max</span>, ])</span><br><span class="line">)</span><br><span class="line"><span class="comment"># Categorical(melted[&#x27;Cat&#x27;], categories=[&#x27;B&#x27;,&#x27;A&#x27;,&#x27;C&#x27;], ordered=True)</span></span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
mean
</th>
<th>
std
</th>
<th>
skew
</th>
<th>
kurt
</th>
<th>
min
</th>
<th>
max
</th>
</tr>
<tr>
<th>
asset_name
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
ew
</th>
<td>
0.012179
</td>
<td>
0.054793
</td>
<td>
-0.308037
</td>
<td>
3.178485
</td>
<td>
-0.272248
</td>
<td>
0.299260
</td>
</tr>
<tr>
<th>
ge
</th>
<td>
0.010519
</td>
<td>
0.065998
</td>
<td>
0.051799
</td>
<td>
1.263640
</td>
<td>
-0.272877
</td>
<td>
0.251236
</td>
</tr>
<tr>
<th>
sp
</th>
<td>
0.006171
</td>
<td>
0.042665
</td>
<td>
-0.591335
</td>
<td>
2.400228
</td>
<td>
-0.239541
</td>
<td>
0.163047
</td>
</tr>
<tr>
<th>
vw
</th>
<td>
0.009316
</td>
<td>
0.043328
</td>
<td>
-0.663129
</td>
<td>
2.388590
</td>
<td>
-0.225363
</td>
<td>
0.165585
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(data</span><br><span class="line">.assign(sp = <span class="keyword">lambda</span> df: df.sp.<span class="built_in">map</span>(replace_dot).astype(<span class="built_in">float</span>))</span><br><span class="line">.assign(ge = <span class="keyword">lambda</span> df: np.log(<span class="number">1</span>+df[<span class="string">&#x27;ge&#x27;</span>]),</span><br><span class="line">        vw = <span class="keyword">lambda</span> df: np.log(<span class="number">1</span>+df.vw),</span><br><span class="line">        ew = <span class="keyword">lambda</span> df: np.log(<span class="number">1</span>+df.ew),</span><br><span class="line">        sp = <span class="keyword">lambda</span> df: np.log(<span class="number">1</span>+df.sp)</span><br><span class="line">)</span><br><span class="line">.melt(id_vars=<span class="string">&#x27;date&#x27;</span>, value_vars=[<span class="string">&#x27;ge&#x27;</span>, <span class="string">&#x27;vw&#x27;</span>, <span class="string">&#x27;ew&#x27;</span>, <span class="string">&#x27;sp&#x27;</span>], var_name=<span class="string">&#x27;asset_name&#x27;</span>, value_name=<span class="string">&#x27;return&#x27;</span>, ignore_index=<span class="literal">True</span>)</span><br><span class="line">.groupby(<span class="string">&#x27;asset_name&#x27;</span>)[<span class="string">&#x27;return&#x27;</span>]</span><br><span class="line">.agg([np.mean, np.std, <span class="string">&#x27;skew&#x27;</span>, pd.Series.kurt, <span class="built_in">min</span>,<span class="built_in">max</span>, ])</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
mean
</th>
<th>
std
</th>
<th>
skew
</th>
<th>
kurt
</th>
<th>
min
</th>
<th>
max
</th>
</tr>
<tr>
<th>
asset_name
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
ew
</th>
<td>
0.010611
</td>
<td>
0.055043
</td>
<td>
-0.748317
</td>
<td>
4.217756
</td>
<td>
-0.317795
</td>
<td>
0.261795
</td>
</tr>
<tr>
<th>
ge
</th>
<td>
0.008318
</td>
<td>
0.065735
</td>
<td>
-0.291798
</td>
<td>
1.806871
</td>
<td>
-0.318660
</td>
<td>
0.224132
</td>
</tr>
<tr>
<th>
sp
</th>
<td>
0.005234
</td>
<td>
0.043130
</td>
<td>
-0.880965
</td>
<td>
3.654802
</td>
<td>
-0.273833
</td>
<td>
0.151043
</td>
</tr>
<tr>
<th>
vw
</th>
<td>
0.008331
</td>
<td>
0.043740
</td>
<td>
-0.946347
</td>
<td>
3.560683
</td>
<td>
-0.255361
</td>
<td>
0.153223
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df2 = data.assign(sp = <span class="keyword">lambda</span> df: df.sp.<span class="built_in">map</span>(replace_dot).astype(<span class="built_in">float</span>))[<span class="string">&#x27;ge&#x27;</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">st.ttest_1samp(df2, popmean=<span class="number">0</span>)</span><br><span class="line">st.ttest_1samp(df2, popmean=<span class="number">0</span>).confidence_interval()</span><br><span class="line"><span class="comment"># 拒绝原假设，不为0.</span></span><br></pre></td></tr></table></figure>
<pre><code>TtestResult(statistic=4.676603474535438, pvalue=3.3855498567456563e-06, df=860)






ConfidenceInterval(low=0.006104055437669108, high=0.014933187303329732)</code></pre>
<h2 id="exercise-3">exercise 3</h2>
<p>Consider the monthly stock returns of S&amp;P composite index from
January 1940 to September 2011 in Problem 2. Perform the following tests
and draw conclusions using the 5% significance level.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># H0: mu = 0</span></span><br><span class="line">df3 = data.assign(sp = <span class="keyword">lambda</span> df: df.sp.<span class="built_in">map</span>(replace_dot).astype(<span class="built_in">float</span>))[<span class="string">&#x27;sp&#x27;</span>]</span><br><span class="line"></span><br><span class="line">np.mean(df3)</span><br><span class="line">st.ttest_1samp(df3, popmean=<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 不为0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># H0 m3 = 0</span></span><br><span class="line">T = <span class="built_in">len</span>(df3)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s = pd.Series.skew(df3)/np.sqrt(<span class="number">6</span>/T)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">k = pd.Series.kurt(df3)/np.sqrt(<span class="number">24</span>/T)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">k</span><br></pre></td></tr></table></figure>
<pre><code>14.376345368117828</code></pre>
<h1 id="chapter-2">chapter 2</h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data = pd.read_fwf(<span class="string">&quot;./数据集/m-ibmsp6709.txt&quot;</span>, headers=T)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data[[<span class="string">&#x27;ibm&#x27;</span>, <span class="string">&#x27;sp&#x27;</span>]].corr(method=<span class="string">&#x27;pearson&#x27;</span>)</span><br><span class="line"></span><br><span class="line">data[[<span class="string">&#x27;ibm&#x27;</span>, <span class="string">&#x27;sp&#x27;</span>]].corr(method=<span class="string">&#x27;spearman&#x27;</span>)</span><br><span class="line"></span><br><span class="line">data[[<span class="string">&#x27;ibm&#x27;</span>, <span class="string">&#x27;sp&#x27;</span>]].corr(method=<span class="string">&#x27;kendall&#x27;</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
ibm
</th>
<th>
sp
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
ibm
</th>
<td>
1.000000
</td>
<td>
0.585654
</td>
</tr>
<tr>
<th>
sp
</th>
<td>
0.585654
</td>
<td>
1.000000
</td>
</tr>
</tbody>
</table>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
ibm
</th>
<th>
sp
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
ibm
</th>
<td>
1.000000
</td>
<td>
0.586082
</td>
</tr>
<tr>
<th>
sp
</th>
<td>
0.586082
</td>
<td>
1.000000
</td>
</tr>
</tbody>
</table>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
ibm
</th>
<th>
sp
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
ibm
</th>
<td>
1.000000
</td>
<td>
0.419659
</td>
</tr>
<tr>
<th>
sp
</th>
<td>
0.419659
</td>
<td>
1.000000
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">st.pearsonr(data[<span class="string">&#x27;ibm&#x27;</span>], data[<span class="string">&#x27;sp&#x27;</span>])</span><br><span class="line"></span><br><span class="line">st.spearmanr(data[<span class="string">&#x27;ibm&#x27;</span>], data[<span class="string">&#x27;sp&#x27;</span>])</span><br><span class="line"></span><br><span class="line">st.kendalltau(data[<span class="string">&#x27;ibm&#x27;</span>], data[<span class="string">&#x27;sp&#x27;</span>])</span><br></pre></td></tr></table></figure>
<pre><code>PearsonRResult(statistic=0.5856543723390125, pvalue=7.81321484822899e-49)






SignificanceResult(statistic=0.5860816570862557, pvalue=6.418453440875322e-49)






SignificanceResult(statistic=0.4196586825963477, pvalue=4.443802333845533e-46)</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">corr()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stock_zh_a_hist_df = ak.stock_zh_a_hist(symbol=<span class="string">&quot;601012&quot;</span>, period=<span class="string">&quot;daily&quot;</span>, start_date=<span class="string">&quot;20210101&quot;</span>, end_date=<span class="string">&#x27;20230330&#x27;</span>, adjust=<span class="string">&quot;qfq&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="arma模型的实现">ARMA模型的实现</h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data = pd.read_fwf(<span class="string">&quot;./数据集/m-ibmsp6709.txt&quot;</span>)</span><br><span class="line">data[[<span class="string">&#x27;ibm&#x27;</span>, <span class="string">&#x27;sp&#x27;</span>]].corr(<span class="string">&quot;spearman&quot;</span>)</span><br><span class="line">data[[<span class="string">&#x27;ibm&#x27;</span>, <span class="string">&#x27;sp&#x27;</span>]].corr(<span class="string">&quot;kendall&quot;</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
ibm
</th>
<th>
sp
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
ibm
</th>
<td>
1.000000
</td>
<td>
0.586082
</td>
</tr>
<tr>
<th>
sp
</th>
<td>
0.586082
</td>
<td>
1.000000
</td>
</tr>
</tbody>
</table>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
ibm
</th>
<th>
sp
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
ibm
</th>
<td>
1.000000
</td>
<td>
0.419659
</td>
</tr>
<tr>
<th>
sp
</th>
<td>
0.419659
</td>
<td>
1.000000
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data = pd.read_table(<span class="string">&quot;./数据集/m-dec12910.txt&quot;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> statsmodels.tsa.arima.model <span class="keyword">import</span> ARIMA</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test_model = ARIMA(data[<span class="string">&#x27;dec1&#x27;</span>], order=(<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>)).fit()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data.assign(</span><br><span class="line">    date = <span class="keyword">lambda</span> df: pd.to_datetime(df.date, <span class="built_in">format</span>=<span class="string">&#x27;%Y%m%d&#x27;</span>), <span class="comment"># 月度数据</span></span><br><span class="line">    </span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
date
</th>
<th>
dec1
</th>
<th>
dec2
</th>
<th>
dec9
</th>
<th>
dec10
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
1967-01-31
</td>
<td>
0.068568
</td>
<td>
0.080373
</td>
<td>
0.180843
</td>
<td>
0.211806
</td>
</tr>
<tr>
<th>
1
</th>
<td>
1967-02-28
</td>
<td>
0.008735
</td>
<td>
0.011044
</td>
<td>
0.048767
</td>
<td>
0.064911
</td>
</tr>
<tr>
<th>
2
</th>
<td>
1967-03-31
</td>
<td>
0.039698
</td>
<td>
0.035364
</td>
<td>
0.067494
</td>
<td>
0.068904
</td>
</tr>
<tr>
<th>
3
</th>
<td>
1967-04-28
</td>
<td>
0.044030
</td>
<td>
0.037541
</td>
<td>
0.040785
</td>
<td>
0.044602
</td>
</tr>
<tr>
<th>
4
</th>
<td>
1967-05-31
</td>
<td>
-0.050631
</td>
<td>
-0.036233
</td>
<td>
-0.002191
</td>
<td>
0.000295
</td>
</tr>
<tr>
<th>
...
</th>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
</tr>
<tr>
<th>
511
</th>
<td>
2009-08-31
</td>
<td>
0.029726
</td>
<td>
0.035835
</td>
<td>
0.044097
</td>
<td>
0.081239
</td>
</tr>
<tr>
<th>
512
</th>
<td>
2009-09-30
</td>
<td>
0.031177
</td>
<td>
0.049051
</td>
<td>
0.074140
</td>
<td>
0.069305
</td>
</tr>
<tr>
<th>
513
</th>
<td>
2009-10-30
</td>
<td>
-0.012101
</td>
<td>
-0.038530
</td>
<td>
-0.080076
</td>
<td>
-0.074620
</td>
</tr>
<tr>
<th>
514
</th>
<td>
2009-11-30
</td>
<td>
0.063006
</td>
<td>
0.051560
</td>
<td>
0.014429
</td>
<td>
0.010572
</td>
</tr>
<tr>
<th>
515
</th>
<td>
2009-12-31
</td>
<td>
0.009555
</td>
<td>
0.047107
</td>
<td>
0.081933
</td>
<td>
0.074133
</td>
</tr>
</tbody>
</table>
<p>
516 rows × 5 columns
</p>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">remove_dups</span>(<span class="params">L1, L2</span>):</span><br><span class="line">    <span class="keyword">for</span> e <span class="keyword">in</span> L1:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="keyword">if</span> e <span class="keyword">in</span> L2:</span><br><span class="line">            L1.remove(e)</span><br><span class="line">            </span><br><span class="line">L1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">L2 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">remove_dups(L1, L2)</span><br></pre></td></tr></table></figure>
<pre><code>1
3
4</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">eg1 = np.array(</span><br><span class="line">    [</span><br><span class="line">        [<span class="number">1.1</span>, -<span class="number">0.18</span>],</span><br><span class="line">        [<span class="number">1</span>,    <span class="number">0</span>   ]</span><br><span class="line">    ]</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.linalg.eig(eg1)</span><br></pre></td></tr></table></figure>
<pre><code>(array([0.9, 0.2]),
 array([[0.66896473, 0.19611614],
        [0.74329415, 0.98058068]]))</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">
      
    </div>
    <footer class="article-footer">
      <a data-url="https://blog.skasis.com/2023/05/25/%E9%87%91%E8%9E%8D%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%88%86%E6%9E%90-python%E5%AE%9E%E7%8E%B0/" data-id="cli3v82yd00003pjc8yf90qor" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2023/05/04/%E9%87%91%E8%9E%8D%E5%9F%BA%E7%A1%80/%E9%87%91%E8%9E%8D%E5%92%8C%E9%87%91%E8%9E%8D%E4%BD%93%E7%B3%BB/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">第一部分：金融和金融体系</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/latex/" rel="tag">latex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%87%91%E8%9E%8D/" rel="tag">金融</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/latex/" style="font-size: 10px;">latex</a> <a href="/tags/%E9%87%91%E8%9E%8D/" style="font-size: 10px;">金融</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/05/25/%E9%87%91%E8%9E%8D%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%88%86%E6%9E%90-python%E5%AE%9E%E7%8E%B0/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/05/04/%E9%87%91%E8%9E%8D%E5%9F%BA%E7%A1%80/%E9%87%91%E8%9E%8D%E5%92%8C%E9%87%91%E8%9E%8D%E4%BD%93%E7%B3%BB/">第一部分：金融和金融体系</a>
          </li>
        
          <li>
            <a href="/2023/04/29/%E9%87%91%E8%9E%8D%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%88%86%E6%9E%90/%E5%B7%AE%E5%88%86%E6%96%B9%E7%A8%8B/">差分方程</a>
          </li>
        
          <li>
            <a href="/2023/04/26/LaTeX/cls%E6%96%87%E4%BB%B6%E4%BD%8D%E7%BD%AE/">自定义cls文件存储位置</a>
          </li>
        
          <li>
            <a href="/2023/04/24/%E9%87%91%E8%9E%8D%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%88%86%E6%9E%90/ARIMA%E6%A8%A1%E5%9E%8B/">ARIMA模型</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 卞儒汉<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>